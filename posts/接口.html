<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Aoike青池</title>

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://aoike.azurice.com/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<!--<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>-->
<!--<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>-->
<!--<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>-->

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    接口.md
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        修改于 · 2021-10-03 10:45:57 · 发布于 · 2021-10-07 02:52:23
                    </time>
                </div>
                <div class="post-content">
                    <h2>接口</h2>
<h3>一、引例</h3>
<pre><code class="hljs language-typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printLabel</span>(<span class="hljs-params">labelledObj: { label: <span class="hljs-built_in">string</span> }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(labelledObj.label);
}

<span class="hljs-keyword">let</span> myObj = { <span class="hljs-attr">size</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">&quot;Size 10 Object&quot;</span> };
printLabel(myObj);
</code></pre>
<p>使用接口来重写：</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> LabelledValue {
  <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printLabel</span>(<span class="hljs-params">labelledObj: LabelledValue</span>) </span>{
  <span class="hljs-built_in">console</span>.log(labelledObj.label);
}

<span class="hljs-keyword">let</span> myObj = {<span class="hljs-attr">size</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">&quot;Size 10 Object&quot;</span>};
printLabel(myObj);
</code></pre>
<p>一个接口好比一个名字来描述要求。上述例子中的接口代表了一个含有 <code><span class="hljs-symbol">value:</span> <span class="hljs-type">string</span></code> 属性的对象。</p>
<p><font color="red">我们在这里并不能像在其它语言里一样，说传给 <code><span class="hljs-attribute">printLabel</span></code>的对象实现了这个接口。我们只会去关注值的外形。 只要传入的对象满足上面提到的必要条件，那么它就是被允许的。</font></p>
<h3>二、接口</h3>
<p>使用 <code><span class="hljs-class"><span class="hljs-keyword">interface</span></span></code> 关键字来声明</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> RectangleConfig {
  color?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 可选属性</span>
  width: <span class="hljs-built_in">number</span>;  <span class="hljs-comment">// 必有属性</span>
  <span class="hljs-keyword">readonly</span> height: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// 只读属性</span>
}
</code></pre>
<p>对于 <code><span class="hljs-keyword">Array</span></code> 有对应的只读类型 <code><span class="hljs-attribute">ReadonlyArray</span></code> ，去掉了可变方法。</p>
<p>对于额外的属性，TypeScript 会检查并抛出错误</p>
<pre><code class="hljs"><span class="hljs-keyword">error: </span>&#x27;colour&#x27; not expected in type &#x27;SquareConfig&#x27;
</code></pre>
<p>但是可以通过添加一个字符串索引签名来说明这个接口兼容额外的属性</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> i {
    [propName: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}
</code></pre>
<p>当然简单一些也可以直接使用类型断言：</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">let</span> mySquare = createSquare({ <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">opacity</span>: <span class="hljs-number">0.5</span> } <span class="hljs-keyword">as</span> SquareConfig);
</code></pre>
<h3>三、描述函数类型</h3>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> SearchFunc {
  (source: <span class="hljs-built_in">string</span>, <span class="hljs-attr">subString</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-keyword">let</span> mySearch: SearchFunc;
mySearch = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">source: <span class="hljs-built_in">string</span>, subString: <span class="hljs-built_in">string</span></span>) </span>{
  <span class="hljs-keyword">let</span> result = source.search(subString);
  <span class="hljs-keyword">return</span> result &gt; -<span class="hljs-number">1</span>;
}
</code></pre>
<blockquote>
<p>函数的参数名不需要与接口里定义的名字相匹配</p>
</blockquote>
<h3>四、描述可索引的类型</h3>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> StringArray {
  [index: <span class="hljs-built_in">number</span>]: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">let</span> myArray: StringArray;
myArray = [<span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-string">&quot;Fred&quot;</span>];

<span class="hljs-keyword">let</span> myStr: <span class="hljs-built_in">string</span> = myArray[<span class="hljs-number">0</span>];
</code></pre>
<blockquote>
<p>TypeScript支持两种索引签名：字符串和数字。</p>
<p>可以同时使用两种类型的索引，但是数字索引的返回值必须是字符串索引返回值类型的子类型。</p>
<p>这是因为当使用 <code><span class="hljs-built_in">number</span></code>来索引时，JavaScript会将它转换成<code><span class="hljs-built_in">string</span></code>然后再去索引对象。 也就是说用 <code>100</code>（一个<code><span class="hljs-built_in">number</span></code>）去索引等同于使用<code><span class="hljs-string">&quot;100&quot;</span></code>（一个<code><span class="hljs-built_in">string</span></code>）去索引，因此两者需要保持一致。</p>
</blockquote>
<p>例：描述一个 <code><span class="hljs-attribute">dictionay</span></code> 模式</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> NumberDictionary {
  [index: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">number</span>;
  length: <span class="hljs-built_in">number</span>;    <span class="hljs-comment">// 可以，length是number类型</span>
  name: <span class="hljs-built_in">string</span>       <span class="hljs-comment">// 错误，`name`的类型与索引类型返回值的类型不匹配</span>
}
</code></pre>
<blockquote>
<p>因为字符串索引声明了 <code>obj.<span class="hljs-keyword">property</span></code>和<code>obj<span class="hljs-selector-attr">[<span class="hljs-string">&quot;property&quot;</span>]</span></code>两种形式都可以。 这个例子里， <code><span class="hljs-built_in">name</span></code>的类型与字符串索引类型不匹配，所以类型检查器给出一个错误提示</p>
</blockquote>
<h3>五、描述类的类型</h3>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> ClockInterface {
    <span class="hljs-attr">currentTime</span>: <span class="hljs-built_in">Date</span>;
    setTime(d: <span class="hljs-built_in">Date</span>);
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Clock</span> <span class="hljs-title">implements</span> <span class="hljs-title">ClockInterface</span> </span>{
    <span class="hljs-attr">currentTime</span>: <span class="hljs-built_in">Date</span>;
    <span class="hljs-function"><span class="hljs-title">setTime</span>(<span class="hljs-params">d: <span class="hljs-built_in">Date</span></span>)</span> {
        <span class="hljs-built_in">this</span>.currentTime = d;
    }
    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">h: <span class="hljs-built_in">number</span>, m: <span class="hljs-built_in">number</span></span>)</span> { }
}
</code></pre>

                </div>
            </article>
        </div>

    </div>
</div>
</body>
</html>
